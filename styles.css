/* 2D Library Room - Nobita's Room Style */
.library-room-wrapper {
    background-color: #f4ece1;
    /* Warm cream/paper background */
    background-image:
        radial-gradient(circle at 2px 2px, rgba(0, 0, 0, 0.05) 1px, transparent 0);
    background-size: 40px 40px;
    height: 100%;
    overflow-y: auto;
    padding: 40px;
}

.library-room {
    max-width: 1200px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 40px;
}

.furniture-zone {
    background: rgba(255, 255, 255, 0.4);
    border: 2px solid #dcd3c1;
    border-radius: 12px;
    padding: 20px;
    min-height: 250px;
    position: relative;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease;
}

.furniture-zone:hover {
    transform: scale(1.02);
    background: rgba(255, 255, 255, 0.6);
}

.zone-title {
    font-family: 'Outfit', 'Inter', sans-serif;
    font-size: 1.4em;
    color: #5c4d3c;
    margin-top: 0;
    margin-bottom: 20px;
    border-bottom: 2px dashed #dcd3c1;
    padding-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.shelf-container {
    display: flex;
    flex-wrap: wrap;
    gap: 30px;
    align-items: flex-end;
}

/* Stacks of books */
.book-stack {
    display: flex;
    flex-direction: column-reverse;
    /* Stack bottom-up */
    position: relative;
    width: 120px;
    height: 151px;
    /* Enough for 8 books */
}

.book-item {
    width: 120px;
    height: 30px;
    background: #fff;
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 3px;
    margin-bottom: -22px;
    /* Overlap for stack look */
    cursor: pointer;
    position: relative;
    padding: 5px 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    z-index: 1;
}

.book-item:hover {
    z-index: 50 !important;
    transform: scale(1.1) rotate(0deg) !important;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
}

.book-title {
    font-size: 11px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    font-weight: 600;
    color: #444;
    max-width: 100%;
}

/* Book Variations */
.book-item.status-active {
    background: #e8f5e9;
    border-left: 5px solid #4caf50;
}

.book-item.status-todo {
    background: #fff3e0;
    border-left: 5px solid #ff9800;
}

.book-item.status-done {
    background: #e3f2fd;
    border-left: 5px solid #2196f3;
}

.book-item.is-canvas {
    background: #fff8e1;
    border-left: 5px solid #ffc107;
    font-style: italic;
}

/* Visual Furniture Decorators */
.zone-journal {
    border-bottom: 10px solid #8d6e63;
}

/* Wood desk look */
.zone-bases {
    border-left: 10px solid #a1887f;
}

/* Shelving look */
.zone-canvas {
    border: 4px double #bcaaa4;
}

/* Archive box look */

/* Image Dashboard Room */
.library-image-room-wrapper {
    background-color: var(--background-primary);
    /* Use theme background */
    height: 100%;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow-y: auto;
    overflow-x: hidden;
}

.room-dashboard {
    position: relative;
    width: 100%;
    max-width: 1200px;
    /* Remove min-height to allow better centering on small screens */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: auto;
    margin: auto;
    padding: 20px;
}

.room-image-container {
    position: relative;
    /* Ensure no gap below image */
    line-height: 0;
    width: 100%;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
    border-radius: 8px;
}

.room-tools {
    position: relative;
    /* Changed from absolute to relative */
    width: 100%;
    display: flex;
    gap: 10px;
    z-index: 10;
    margin-bottom: 15px;
    justify-content: flex-end;
    /* Align buttons to the right */
}

.room-tools button {
    background: rgba(141, 110, 99, 0.9);
    backdrop-filter: blur(10px);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 500;
    font-size: 13px;
    transition: all 0.2s;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

.room-tools button:hover {
    background: #5d4037;
    transform: translateY(-2px);
}

.room-tools button.is-active {
    background: #d32f2f;
}

.room-tools select {
    background: rgba(141, 110, 99, 0.9);
    backdrop-filter: blur(10px);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 8px 12px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 500;
    font-size: 13px;
    outline: none;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

.room-tools select option {
    background: #5d4037;
    color: white;
}

.selection-rect {
    position: absolute;
    border: 2px dashed #fff;
    background: rgba(255, 255, 255, 0.2);
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
    pointer-events: none;
    z-index: 1000;
}

.folder-section {
    margin-bottom: 20px;
}

.folder-title {
    font-size: 0.75em;
    text-transform: uppercase;
    letter-spacing: 1.2px;
    color: #888;
    margin: 15px 15px 8px 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    padding-bottom: 4px;
}

.room-bg-img {
    width: 100%;
    height: auto;
    display: block;
    user-select: none;
    -webkit-user-drag: none;
    border-radius: 8px;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
}

.room-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

/* Legacy Hotspot - kept for reference if needed, but handled by SVG mostly now */
.hotspot {
    position: absolute;
    cursor: pointer;
    background: rgba(255, 255, 255, 0);
    border: 2px solid transparent;
    border-radius: 10px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.hotspot:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.5);
    box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.2);
}

.hotspot-label {
    opacity: 0;
    background: rgba(0, 0, 0, 0.7);
    color: #fff;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    transform: translateY(10px);
    transition: all 0.3s ease;
    pointer-events: none;
}

.hotspot-label {
    opacity: 0;
    pointer-events: none;
    position: absolute;
    /* Center label relative to anchor */
    transform: translate(-50%, -100%);
    margin-top: -10px;
    background: rgba(0, 0, 0, 0.7);
    color: #fff;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    transition: all 0.2s ease;
    white-space: nowrap;
    z-index: 2000;
}

.hotspot-shape {
    transition: all 0.2s ease;
    fill: transparent;
    stroke: transparent;
}

.hotspot-shape:hover {
    fill: rgba(255, 255, 255, 0.2) !important;
    stroke: rgba(255, 255, 255, 0.8) !important;
    stroke-width: 1;
    /* This is in SVG coords 0-100 */
}

/* When hovering outline, show label on associated anchor?
   This is tricky with CSS only since they are siblings or cousins.
   We handled this in JS by setting opacity, or we can use generic sibling selector if DOM order permits.
   BUT, the anchor is separate from the SVG shape in DOM.
   We will rely on JS events or we can put the label inside a foreignObject in SVG?
   
   Actually, let's keep it simple:
   The JS "mouseenter" on SVG shape adds a class to the anchor or label.
*/
.hotspot-anchor.is-active .hotspot-label {
    opacity: 1;
    transform: translate(-50%, -120%);
}

/* Zone Detail Panel - Wood Má»™c Theme */
.zone-detail-panel {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 450px;
    min-width: 300px;
    max-height: 80%;
    background: #e6d5b8;
    /* Light raw wood color */
    background-image: linear-gradient(rgba(255, 255, 255, 0.1) 1px, transparent 1px);
    background-size: 100% 30px;
    /* Slight wood grain feel */
    border: 3px solid #8d6e63;
    /* Darker wood border */
    border-radius: 12px;
    box-shadow: 0 30px 80px rgba(0, 0, 0, 0.6);
    z-index: 500;
    display: flex;
    flex-direction: column;
    animation: panelPop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    color: #3e2723;
    /* Deep coffee wood text */
}

@keyframes panelPop {
    from {
        opacity: 0;
        transform: translate(-50%, -40%) scale(0.9);
    }

    to {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
    }
}

.panel-header {
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #8d6e63;
    color: #fff;
    border-bottom: 2px solid #5d4037;
    min-height: 50px;
}

.panel-header h2 {
    margin: 0;
    font-size: 1.1em;
    font-family: 'Outfit', sans-serif;
    letter-spacing: 0.5px;
}

.header-controls {
    display: flex;
    align-items: center;
    gap: 10px;
}

.header-controls button,
.panel-header button {
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #fff;
    border-radius: 4px;
    width: 28px;
    height: 28px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s;
}

.header-controls button:hover,
.panel-header button:hover {
    background: rgba(0, 0, 0, 0.4);
}

.panel-file-list {
    padding: 15px;
    overflow-y: auto;
    flex: 1;
}

.file-item {
    padding: 10px 15px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
    background: rgba(255, 255, 255, 0.3);
    border: 1px solid rgba(141, 110, 99, 0.2);
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 12px;
}

.file-item:hover {
    background: #fff;
    transform: translateX(5px);
    border-color: #8d6e63;
}

.folder-item {
    font-weight: bold;
    background: rgba(141, 110, 99, 0.1);
}

.back-item {
    background: #bcaaa4;
    color: #3e2723;
    font-weight: bold;
    border-bottom: 2px solid #8d6e63;
}

.file-name {
    font-weight: 500;
    font-size: 14px;
}

.empty-msg {
    padding: 40px;
    text-align: center;
    color: #666;
    font-style: italic;
}

/* Modals & Context Menus */
.shape-context-menu,
.sort-dropdown-menu {
    position: fixed;
    background-color: var(--background-secondary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 4px 0;
    z-index: 10000;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    min-width: 160px;
}

.sort-dropdown-menu {
    min-width: 200px;
}

.shape-menu-item,
.sort-option {
    padding: 6px 14px;
    cursor: pointer;
    color: var(--text-normal);
    font-size: 13px;
    transition: background 0.1s;
}

.shape-menu-item:hover,
.sort-option:hover {
    background-color: var(--background-modifier-hover);
}

.sort-option.is-active {
    color: var(--interactive-accent);
    font-weight: 600;
}

/* Edge Editing Buttons */
.edge-edit-btns {
    display: flex;
    gap: 4px;
    z-index: 100;
    pointer-events: auto;
}

.edge-edit-btns button {
    padding: 4px 8px;
    border-radius: 4px;
    color: white;
    border: none;
    cursor: pointer;
    font-size: 14px;
    transition: opacity 0.2s;
}

.edge-edit-btns button:hover {
    opacity: 0.8;
}

.edge-edit-btns .btn-confirm {
    background-color: #2e7d32;
}

.edge-edit-btns .btn-cancel {
    background-color: #c62828;
}

/* Generic Modal Helpers */
.hotspot-modal input {
    width: 100%;
    margin-bottom: 15px;
    padding: 6px 10px;
    border-radius: 4px;
    background: var(--background-primary);
    border: 1px solid var(--background-modifier-border);
    color: var(--text-normal);
}

.hotspot-modal label {
    display: block;
    font-weight: 600;
    margin-bottom: 5px;
    font-size: 0.9em;
}

.sort-bar {
    display: flex;
    justify-content: flex-end;
    padding: 4px 8px;
    border-bottom: 1px solid var(--background-modifier-border);
}

.sort-bar button {
    font-size: 12px;
    padding: 2px 8px;
    border-radius: 4px;
    cursor: pointer;
    background-color: transparent;
    border: 1px solid var(--background-modifier-border);
    color: var(--text-muted);
}